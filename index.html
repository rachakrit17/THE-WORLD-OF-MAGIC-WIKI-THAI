
<!doctype html><html lang="th"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>THE‑WORLD‑OF‑MAGIC‑WIKI‑THAI — หน้าหลัก</title>
<meta name="theme-color" content="#8F55FF">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="bg-dark text-light">
<div id="topnav"></div>

<header class="py-5 bg-hero">
  <div class="container text-center">
    <h1 class="display-6 fw-bold mb-2 brand-grad">THE‑WORLD‑OF‑MAGIC‑WIKI‑THAI</h1>
    <p class="lead opacity-70">ฐานความรู้ภาษาไทย ครบทั้งไกด์ อาชีพ แผนที่ อุปกรณ์ และกิจกรรม</p>
    <div class="d-flex justify-content-center gap-2 mt-3">
      <a href="guides.html" class="btn btn-lg btn-neon tilt">เริ่มสำรวจ 🚀</a>
      <button id="btnSearch" class="btn btn-lg btn-outline-light tilt">🔎 ค้นหา</button>
    </div>
  </div>
</header>

<main class="container my-5">
  <div class="row g-4">
    <div class="col-lg-8">
      <h2 class="h4 mb-3">📌 ไกด์ล่าสุด</h2>
      <div id="homeGuides" class="row g-3"></div>
    </div>
    <div class="col-lg-4">
      <div class="neon p-3 rounded-2xl">
        <h3 class="h6">📁 สำรวจตามหมวด</h3>
        <div class="d-grid gap-2 mt-2">
          <a class="btn btn-outline-light" href="classes.html">🛡️ อาชีพ</a>
          <a class="btn btn-outline-light" href="maps.html">🗺️ แผนที่</a>
          <a class="btn btn-outline-light" href="equipment.html">⚙️ อุปกรณ์</a>
          <a class="btn btn-outline-light" href="events.html">🎉 อีเวนต์</a>
        </div>
      </div>
      <div class="neon p-3 mt-3 rounded-2xl">
        <h3 class="h6">💡 ทริควันนี้</h3>
        <div class="small hint">กด / เพื่อเปิดค้นหาเร็ว 🔎</div>
      </div>
    </div>
  </div>
  <section class="mt-4">
    <div class="neon p-3 rounded-2xl">
      <div id="featureSlider" class="overflow-hidden position-relative" style="height:180px">
        <div id="slides" class="d-flex" style="gap:12px; transition:transform .6s ease"></div>
      </div>
    </div>
  </section>
</main>

<div id="footer"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/i18next@23.11.5/dist/umd/i18next.min.js"></script>
<script src="assets/js/i18n.js"></script>
<script src="assets/js/firebase-init.js"></script>
<script src="assets/js/auth.js"></script>
<script src="assets/js/fx.js"></script>
<script src="assets/js/app.js"></script>
<script>
  window.renderShell && window.renderShell();
  (async function(){
    const lang = i18next.language || 'th';
    const con = document.getElementById('homeGuides');
    const snap = await db.collection('guides').where('published','==', true).limit(200).get();
    const docs = snap.docs.map(d=>({id:d.id, ...d.data()}))
      .sort((a,b)=> (b.updatedAt?.toMillis?.() || +new Date(b.updatedAt||0)) - (a.updatedAt?.toMillis?.() || +new Date(a.updatedAt||0)))
      .slice(0,6);
    con.innerHTML = docs.map(g=>{
      const title = (lang==='th' && g.title_th) ? g.title_th : (g.title_en||'');
      const img = g.image || '';
      const excerpt = (lang==='th' && g.content_th ? g.content_th : g.content_en || '').replace(/<[^>]+>/g,'').slice(0,120);
      return `<div class="col-md-6"><a href="guides.html#${g.slug||g.id}" class="card h-100 neon tilt link-light">
        ${img? `<img src="${img}" class="card-img-top">`:''}
        <div class="card-body"><h3 class="h6 mb-2">💫 ${title}</h3><p class="small opacity-70">${excerpt}…</p></div></a></div>`;
    }).join('') || '<div class="text-secondary">ยังไม่มีไกด์ที่เผยแพร่</div>';
  })();
  (async function(){
    const slides = document.getElementById('slides');
    const snap = await db.collection('events').where('published','==', true).limit(12).get();
    const items = snap.docs.map(d=> d.data()).filter(x=>x.banner).sort((a,b)=> (b.startsAt?.toMillis?.() || +new Date(b.startsAt||0)) - (a.startsAt?.toMillis?.() || +new Date(a.startsAt||0)));
    slides.innerHTML = items.map(x=>`<img src="${x.banner}" alt="" class="rounded-3" style="height:150px;object-fit:cover">`).join('');
    let i = 0; setInterval(()=>{ if(items.length>1){ i=(i+1)%items.length; slides.style.transform = 'translateX('+(-i*162)+'px)'; } }, 2800);
  })();
</script>
</body></html>
